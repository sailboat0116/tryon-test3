<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>結果分析</title>
  <style>
    body {
      background-image: url('images/example_back.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      margin: 0;
      padding: 0;
      position: relative;
      font-family: Arial, sans-serif;
    }
    .container {
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: 50px;
      gap: 40px;
    }
    .image-container {
      margin-right: 100px; /* 向左移動圖片 */
      text-align: center;
    }
    .image-container svg {
      max-width: 110%;
      height: 425px;
      border-radius: 10px;
      background-color: rgba(186, 186, 186, 0.76); /* 輕綠色背景 */
      box-shadow: 0 4px 8px black; /* 添加陰影 */
    }
    .result-container {
      font-size: 18px;
      text-align: center;
      background-color: rgba(186, 186, 186, 0.76); /* 輕綠色背景 */
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 4px 8px black; /* 添加陰影 */
      width: 350px;
      position: relative; /* 允許小圖絕對定位 */
    }
    .result-container p {
      margin: 10px 0;
    }
    .text-box {
      margin-top: 20px;
      background-color: #e4d0ba; /* 淡綠色背景 */
      border: 2px solid #34453a; /* 綠色邊框 */
      border-radius: 10px; /* 圓角 */
      box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1); /* 輕微陰影 */
      padding: 15px;
      font-size: 16px;
      width: 300px;
      position: relative;
    }
    .text-box::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 8px;
      height: 8px;
      background-color: #405346; /* 綠色角落背景 */
      border-top-left-radius: 10px;
    }
    .text-box p {
      margin: 10px 0;
    }
    .quiz-options button {
      margin-top: 10px;
      padding: 10px 20px;
      background-color: #ADD8E6;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s;
    }
    .quiz-options button:hover {
      background-color: #e5a3ad;
    }
    .start-button {
      margin-top: 30px;
      padding: 15px 30px;
      background-color: #a5a58d;
      border: none;
      color: white;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
    .button-container {
      text-align: center; /* 將按鈕放置於中間 */
      margin-top: 20px;
    }
    .icon {
      position: absolute;
      bottom: 100px;
      right: 175px;
      width: 70px;
      height: 70px;
      cursor: pointer;
      font-weight: bold;
      text-align: left;
      margin-bottom: 15px;
      border-radius: 50%;
      border: 2px solid black; /* 添加黑色外框 */
      background-color: white; /* 可以加上背景顏色以便外框顯示清晰 */
    }
  </style>
</head>
<body>
<div class="container">
  <div class="image-container">
    <svg width="400" height="400" viewBox="-250 -250 500 500">
      <!-- 背景線 -->
      <g stroke=black stroke-width="1">
        <path d="M0,-180 L0,180 M-180,0 L180,0" />
      </g>

      <!-- 多邊形 -->
      <g fill="none" stroke=black stroke-width="1">
        <polygon points="0,-180 180,0 0,180 -180,0" />
        <polygon points="0,-150 150,0 0,150 -150,0" />
        <polygon points="0,-120 120,0 0,120 -120,0" />
        <polygon points="0,-90 90,0 0,90 -90,0" />
        <polygon points="0,-60 60,0 0,60 -60,0" />
        <polygon points="0,-30 30,0 0,30 -30,0" />
      </g>

      <!-- 數據多邊形，線條更改為黑色 -->
      <polygon id="dataPolygon" points="0,-180 150,0 0,180 -90,0" fill="rgba(228,208,186,0.8)" stroke="rgba(108, 60, 0)" stroke-width="2"/>

      <!-- 標籤 -->
      <g font-size="20" text-anchor="middle" fill="#333">
        <text x="0" y="-230">風格</text>
        <text x="230" y="5">顏色</text>
        <text x="0" y="245">季節</text>
        <text x="-230" y="5">場合</text>
      </g>
    </svg>
  </div>

  <!-- 顯示 API 回傳內容的區域 -->
  <div class="result-container">
    <h2>答題錯誤統計</h2>
    <p><strong>風格 : </strong> <span id="type1">0</span><strong> 題</strong></p>
    <p><strong>顏色 : </strong> <span id="type2">0</span><strong> 題</strong></p>
    <p><strong>季節 : </strong> <span id="type3">0</span><strong> 題</strong></p>
    <p><strong>場合 : </strong> <span id="type4">0</span><strong> 題</strong></p>

    <!-- 添加的文字框 -->
    <div class="text-box">
      <p>透過此圖，您可以瞭解對於四個方向穿搭知識的學習程度，若您還有其他需要了解的部分，請與穿搭助理Marcus對話。</p>
      <p>希望此教學系統能讓您對於服裝搭配更加熟悉。</p>
    </div>
  </div>

  <!-- 小圖標，點擊後跳轉到 chatbot.html -->
  <img src="images/profile-icon.png" class="icon" alt="Chat Icon" onclick="window.location.href='/chatbot.html'"/>
</div>

<!-- 回首頁按鈕，置中對齊 -->
<div class="button-container">
  <button class="start-button" onclick="window.location.href='/category_selection.html'">回首頁</button>
</div>

<script>
  // 模擬的 user_id，你可以從其他方式獲得
  const userId = 'dennis';

  // 發送 API 請求，獲取資料
  fetch('/api/result', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ user_id: userId })
  })
          .then(response => response.json())
          .then(data => {
            // 將 API 回傳的資料顯示在頁面上
            document.getElementById('type1').textContent = data.type1;
            document.getElementById('type2').textContent = data.type2;
            document.getElementById('type3').textContent = data.type3;
            document.getElementById('type4').textContent = data.type4;

            // 動態更新 SVG 的多邊形根據 type1 - type4 的數據
            const type1Value = -180 + 30 * data.type1; // 根據 type1 計算 y 座標
            const type2Value = 180 - 30 * data.type2; // x 座標根據圖形
            const type3Value = 180 - 30 * data.type3; // y 座標
            const type4Value = -180 + 30 * data.type4; // x 座標

            // 更新多邊形的 points 屬性
            const polygonPoints = `${0},${type1Value} ${type2Value},0 0,${type3Value} ${type4Value},0`;
            document.getElementById('dataPolygon').setAttribute('points', polygonPoints);
          })
          .catch(error => {
            console.error('Error fetching data:', error);
          });
</script>

</body>
</html>
