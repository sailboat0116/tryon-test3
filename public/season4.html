<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>季節_選擇題</title>
  <style>
    body {
      background-color: #efdaa7;
      margin: 0;
      padding: 0;
      position: relative;
    }
    .container {
      display: flex;
      align-items: center;
      padding: 20px;
    }
    .image-container {
      display: grid;
      grid-template-columns: repeat(2, 1fr); /* 兩張圖片一行 */
      gap: 10px;
      flex: 1;
      margin: 0 10px;
    }
    .image-container img {
      width: 100%; /* 讓圖片填滿格子 */
      height: 200px; /* 設定固定高度，保持大小一致 */
      object-fit: cover; /* 確保圖片不會變形 */
      border-radius: 10px;
    }
    .quiz-box {
      flex: 1;
      padding: 10px;
      background-color: #f9f9f9;
      border-radius: 10px;
      text-align: center;
      margin-left: 20px;
    }
    .quiz-options {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .quiz-options button {
      margin-top: 10px;
      padding: 10px 20px;
      background-color: #ADD8E6;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s;
    }
    .quiz-options button:hover {
      background-color: #e5a3ad;
    }
    .upload-button {
      margin-top: 10px;
    }
    .confirm-button {
      margin-top: 30px;
      padding: 15px 30px;
      background-color: #4CAF50;
      border: none;
      color: white;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
    .correct-option::after {
      content: "✔"; /* 打勾符號 */
      color: green;
      font-size: 18px;
      margin-left: 10px;
    }
    .wrong-option::after {
      content: "✘"; /* 錯誤選項打叉符號 */
      color: red;
      font-size: 18px;
      margin-left: 10px;
    }
    .disabled-option {
      background-color: #acd7e5;
      cursor: not-allowed;
    }
    .start-button {
      margin-top: 30px;
      padding: 15px 30px;
      background-color: #a5a58d;
      border: none;
      color: white;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const confirmButton = document.querySelector('#confirmButton');
      const optionButtons = document.querySelectorAll('.quiz-options button');
      let selectedOptions = [];
      const correctAnswers = ["雪紡紗"];

      // 選擇選項
      optionButtons.forEach(button => {
        button.addEventListener('click', function() {
          const option = this.textContent;
          if (selectedOptions.includes(option)) {
            selectedOptions = selectedOptions.filter(opt => opt !== option);
            this.style.backgroundColor = '#ADD8E6';
          } else {
            if (selectedOptions.length < 1) {
              selectedOptions.push(option);
              this.style.backgroundColor = '#e5a3ad';
            } else {
              alert('最多只能選擇一個選項');
            }
          }
        });
      });

      // 確認答案
      confirmButton.addEventListener('click', function() {
        if (selectedOptions.length === 1) {
          let correctCount = 0;  // 計算答對的數量
          selectedOptions.forEach(option => {
            if (correctAnswers.includes(option)) {
              correctCount++;
            }
          });

          if (correctCount === 1) {
            selectedOptions.forEach(option => {
              optionButtons.forEach(button => {
                if (button.textContent === option) {
                  button.classList.add('correct-option'); // 顯示打勾
                }
              });
            });
            logCorrectAnswer();
          } else {
            optionButtons.forEach(button => {
              if (selectedOptions.includes(button.textContent)) {
                button.classList.add('wrong-option');   // 錯誤答案顯示打叉
                button.style.backgroundColor = '#ADD8E6'; // 回到藍色
              }
            });
            // 顯示所有正確的答案
            optionButtons.forEach(button => {
              if (correctAnswers.includes(button.textContent)) {
                button.style.backgroundColor = '#e4a2ac';  // 正確答案顯示為紅色
              }
            });
          }

          // 如果 correctCount 為 0 ，則記錄到資料庫
          if (correctCount < 1) {
            logWrongAnswer();
          }
        } else {
          alert('請選擇一個選項');
        }
      });

      // 新增函數：記錄錯誤答案到資料庫
      function logWrongAnswer() {
        fetch('/api/wrong', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            user_id: 'dennis',
            type: 3,
            number: 4
          })
        })
                .then(response => response.json())
                .then(data => {
                  alert('您的答案已記錄，謝謝參與！');
                })
                .catch(error => {
                  alert('抱歉，記錄答案時出現問題。請稍後再試。');
                });
      }


      function logCorrectAnswer() {
        fetch('/api/correct', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            user_id: 'dennis',
            type: 3,
            number: 4
          })
        })
                .then(response => response.json())
                .then(data => {
                  if (data.success) {
                    alert(data.message);  // 顯示刪除成功或其他訊息
                  } else {
                    alert('恭喜答對');
                  }
                })
                .catch(error => {
                  console.error('操作時出錯:', error);
                  alert('操作失敗，請稍後再試。');
                });

      }
    });

  </script>
</head>
<body>
<div class="container">
  <div class="image-container">
    <img src="uploads/season1-1.jpg" alt="圖片1">
    <img src="uploads/season4-1.jpg" alt="圖片2">
    <img src="uploads/season1-3.jpg" alt="圖片3">
    <img src="uploads/season1-4.jpeg" alt="圖片4">
  </div>

  <div class="quiz-box">
    <h2>請問適合春天的材質是下列哪一個?</h2>
    <div class="quiz-options">
      <button>雪紡紗</button>
      <button>毛料</button>
      <button>麂皮</button>
      <button>棉</button>
    </div>
    <button id="confirmButton" class="confirm-button">確認答案</button>
  </div>
</div>
<button class="start-button" onclick="window.location.href='/season5.html'">前往題目五</button>
</body>
</html>
